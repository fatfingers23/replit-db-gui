import{k as O,aW as Se,H as fe,y as Pe,aX as Ie,K as Te,X as S,p as Ee,ac as ue,l as J,f as a,R as Be,ad as pe,ai as me,Y as k,Z as xe,n as j,a1 as De,I as re,am as R,aY as $e,B as Re,aZ as Fe,F as Ne,a_ as Ue,P as Ae,U as Ke,aa as Le,ay as He,a7 as je,a as y,aw as ze,a2 as H,av as Ge,az as Oe,a3 as le,an as Q,a$ as Je,a9 as de,aB as Me,ak as We,aO as Ye,d as ge,s as V,u as Xe,o as D,c as F,w as r,V as ce,b as s,g as h,t as K,h as z,b0 as ne,b1 as Ze,i as Y,b2 as qe,b3 as Qe,e as X,r as ea,b4 as aa}from"./index.cf337e7e.js";import{m as he,u as ta,f as la,W as na,d as oa,b as sa,c as Z,V as q}from"./lazy.c1fb1597.js";import{_ as ia}from"./json-editor-vue.7333c4d4.js";import{V as ua}from"./VAlert.e502b11f.js";import{a as ra,b as da,u as ca,f as va,d as fa,e as pa,g as ma,h as xa,V as ve}from"./VTextField.42825f50.js";function ga(e,p,l){var t,f,o;p===void 0&&(p=50),l===void 0&&(l={});var c=(t=l.isImmediate)!=null&&t,m=(f=l.callback)!=null&&f,b=l.maxWait,C=Date.now(),w=[];function P(){if(b!==void 0){var u=Date.now()-C;if(u+p>=b)return b-u}return p}var x=function(){var u=[].slice.call(arguments),g=this;return new Promise(function(I,N){var i=c&&o===void 0;if(o!==void 0&&clearTimeout(o),o=setTimeout(function(){if(o=void 0,C=Date.now(),!c){var n=e.apply(g,u);m&&m(n),w.forEach(function($){return(0,$.resolve)(n)}),w=[]}},P()),i){var d=e.apply(g,u);return m&&m(d),I(d)}w.push({resolve:I,reject:N})})};return x.cancel=function(u){o!==void 0&&clearTimeout(o),w.forEach(function(g){return(0,g.reject)(u)}),w=[]},x}const G=Symbol.for("vuetify:v-expansion-panel"),ha=["default","accordion","inset","popout"],Va=O({name:"VExpansionPanels",props:{color:String,variant:{type:String,default:"default",validator:e=>ha.includes(e)},readonly:Boolean,...Se(),...fe(),...Pe()},emits:{"update:modelValue":e=>!0},setup(e,p){let{slots:l}=p;Ie(e,G);const{themeClasses:t}=Te(e),f=S(()=>e.variant&&`v-expansion-panels--variant-${e.variant}`);return Ee({VExpansionPanel:{color:ue(e,"color")},VExpansionPanelTitle:{readonly:ue(e,"readonly")}}),J(()=>a(e.tag,{class:["v-expansion-panels",t.value,f.value]},l)),{}}}),Ve=De({color:String,expandIcon:{type:re,default:"$expand"},collapseIcon:{type:re,default:"$collapse"},hideActions:Boolean,ripple:{type:[Boolean,Object],default:!1},readonly:Boolean},"v-expansion-panel-title"),be=O({name:"VExpansionPanelTitle",directives:{Ripple:Be},props:{...Ve()},setup(e,p){let{slots:l}=p;const t=pe(G);if(!t)throw new Error("[Vuetify] v-expansion-panel-title needs to be placed inside v-expansion-panel");const{backgroundColorClasses:f,backgroundColorStyles:o}=me(e,"color"),c=S(()=>({collapseIcon:e.collapseIcon,disabled:t.disabled.value,expanded:t.isSelected.value,expandIcon:e.expandIcon,readonly:e.readonly}));return J(()=>{var m;return k(a("button",{class:["v-expansion-panel-title",{"v-expansion-panel-title--active":t.isSelected.value},f.value],style:o.value,type:"button",tabindex:t.disabled.value?-1:void 0,disabled:t.disabled.value,"aria-expanded":t.isSelected.value,onClick:e.readonly?void 0:t.toggle},[a("span",{class:"v-expansion-panel-title__overlay"},null),(m=l.default)==null?void 0:m.call(l,c.value),!e.hideActions&&a("span",{class:"v-expansion-panel-title__icon"},[l.actions?l.actions(c.value):a(j,{icon:t.isSelected.value?e.collapseIcon:e.expandIcon},null)])]),[[xe("ripple"),e.ripple]])}),{}}}),oe=O({name:"VExpansionPanelText",props:{...he()},setup(e,p){let{slots:l}=p;const t=pe(G);if(!t)throw new Error("[Vuetify] v-expansion-panel-text needs to be placed inside v-expansion-panel");const{hasContent:f,onAfterLeave:o}=ta(e,t.isSelected);return J(()=>{var c;return a($e,{onAfterLeave:o},{default:()=>[k(a("div",{class:"v-expansion-panel-text"},[l.default&&f.value&&a("div",{class:"v-expansion-panel-text__wrapper"},[(c=l.default)==null?void 0:c.call(l)])]),[[R,t.isSelected.value]])]})}),{}}}),ba=O({name:"VExpansionPanel",props:{title:String,text:String,bgColor:String,...Re(),...Fe(),...he(),...Ne(),...fe(),...Ve()},emits:{"group:selected":e=>!0},setup(e,p){let{slots:l}=p;const t=Ue(e,G),{backgroundColorClasses:f,backgroundColorStyles:o}=me(e,"bgColor"),{elevationClasses:c}=Ae(e),{roundedClasses:m}=Ke(e),b=S(()=>(t==null?void 0:t.disabled.value)||e.disabled),C=S(()=>t.group.items.value.reduce((x,u,g)=>(t.group.selected.value.includes(u.id)&&x.push(g),x),[])),w=S(()=>{const x=t.group.items.value.findIndex(u=>u.id===t.id);return!t.isSelected.value&&C.value.some(u=>u-x===1)}),P=S(()=>{const x=t.group.items.value.findIndex(u=>u.id===t.id);return!t.isSelected.value&&C.value.some(u=>u-x===-1)});return Le(G,t),J(()=>{var x;const u=!!(l.text||e.text),g=!!(l.title||e.title);return a(e.tag,{class:["v-expansion-panel",{"v-expansion-panel--active":t.isSelected.value,"v-expansion-panel--before-active":w.value,"v-expansion-panel--after-active":P.value,"v-expansion-panel--disabled":b.value},m.value,f.value],style:o.value,"aria-expanded":t.isSelected.value},{default:()=>[a("div",{class:["v-expansion-panel__shadow",...c.value]},null),g&&a(be,{key:"title",collapseIcon:e.collapseIcon,color:e.color,expandIcon:e.expandIcon,hideActions:e.hideActions,ripple:e.ripple},{default:()=>[l.title?l.title():e.title]}),u&&a(oe,{key:"text",eager:e.eager},{default:()=>[l.text?l.text():e.text]}),(x=l.default)==null?void 0:x.call(l)]})}),{}}});const ya=O({name:"VTextarea",directives:{Intersect:He},inheritAttrs:!1,props:{autoGrow:Boolean,autofocus:Boolean,counter:[Boolean,Number,String],counterValue:Function,hint:String,persistentHint:Boolean,prefix:String,placeholder:String,persistentPlaceholder:Boolean,persistentCounter:Boolean,noResize:Boolean,rows:{type:[Number,String],default:5,validator:e=>!isNaN(parseFloat(e))},maxRows:{type:[Number,String],validator:e=>!isNaN(parseFloat(e))},suffix:String,...ra(),...da()},emits:{"click:control":e=>!0,"update:focused":e=>!0,"update:modelValue":e=>!0},setup(e,p){let{attrs:l,emit:t,slots:f}=p;const o=je(e,"modelValue"),{isFocused:c,focus:m,blur:b}=ca(e),C=S(()=>typeof e.counterValue=="function"?e.counterValue(o.value):(o.value||"").toString().length),w=S(()=>{if(l.maxlength)return l.maxlength;if(!(!e.counter||typeof e.counter!="number"&&typeof e.counter!="string"))return e.counter});function P(v,T){var E,B;!e.autofocus||!v||(E=T[0].target)==null||(B=E.focus)==null||B.call(E)}const x=y(),u=y(),g=y(""),I=y(),N=S(()=>c.value||e.persistentPlaceholder),i=S(()=>e.messages.length?e.messages:N.value||e.persistentHint?e.hint:"");function d(){if(I.value!==document.activeElement){var v;(v=I.value)==null||v.focus()}c.value||m()}function n(v){d(),t("click:control",v)}function $(v){v.stopPropagation(),d(),de(()=>{o.value="",Me(e["onClick:clear"],v)})}function _(v){o.value=v.target.value}const U=y();function A(){!e.autoGrow||de(()=>{if(!U.value||!u.value)return;const v=getComputedStyle(U.value),T=getComputedStyle(u.value.$el),E=parseFloat(v.getPropertyValue("--v-field-padding-top"))+parseFloat(v.getPropertyValue("--v-input-padding-top"))+parseFloat(v.getPropertyValue("--v-field-padding-bottom")),B=U.value.scrollHeight,ee=parseFloat(v.lineHeight),ae=Math.max(parseFloat(e.rows)*ee+E,parseFloat(T.getPropertyValue("--v-input-control-height"))),te=parseFloat(e.maxRows)*ee+E||1/0;g.value=We(Ye(B!=null?B:0,ae,te))})}ze(A),H(o,A),H(()=>e.rows,A),H(()=>e.maxRows,A),H(()=>e.density,A);let M;return H(U,v=>{if(v)M=new ResizeObserver(A),M.observe(U.value);else{var T;(T=M)==null||T.disconnect()}}),Ge(()=>{var v;(v=M)==null||v.disconnect()}),J(()=>{const v=!!(f.counter||e.counter||e.counterValue),T=!!(v||f.details),[E,B]=Oe(l),[{modelValue:ee,...ae}]=va(e),[te]=fa(e);return a(xa,le({ref:x,modelValue:o.value,"onUpdate:modelValue":L=>o.value=L,class:["v-textarea v-text-field",{"v-textarea--prefixed":e.prefix,"v-textarea--suffixed":e.suffix,"v-text-field--prefixed":e.prefix,"v-text-field--suffixed":e.suffix,"v-textarea--auto-grow":e.autoGrow,"v-textarea--no-resize":e.noResize||e.autoGrow,"v-text-field--flush-details":["plain","underlined"].includes(e.variant)}],"onClick:prepend":e["onClick:prepend"],"onClick:append":e["onClick:append"]},E,ae,{focused:c.value,messages:i.value}),{...f,default:L=>{let{isDisabled:W,isDirty:se,isReadonly:ye,isValid:we}=L;return a(pa,le({ref:u,style:{"--v-textarea-control-height":g.value},"onClick:control":n,"onClick:clear":$,"onClick:prependInner":e["onClick:prependInner"],"onClick:appendInner":e["onClick:appendInner"],role:"textbox"},te,{active:N.value||se.value,dirty:se.value||e.dirty,focused:c.value,error:we.value===!1}),{...f,default:_e=>{let{props:{class:ie,...Ce}}=_e;return a(Q,null,[e.prefix&&a("span",{class:"v-text-field__prefix"},[e.prefix]),k(a("textarea",le({ref:I,class:ie,value:o.value,onInput:_,autofocus:e.autofocus,readonly:ye.value,disabled:W.value,placeholder:e.placeholder,rows:e.rows,name:e.name,onFocus:d,onBlur:b},Ce,B),null),[[xe("intersect"),{handler:P},null,{once:!0}]]),e.autoGrow&&k(a("textarea",{class:[ie,"v-textarea__sizer"],"onUpdate:modelValue":ke=>o.value=ke,ref:U,readonly:!0,"aria-hidden":"true"},null),[[Je,o.value]]),e.suffix&&a("span",{class:"v-text-field__suffix"},[e.suffix])])}})},details:T?L=>{var W;return a(Q,null,[(W=f.details)==null?void 0:W.call(f,L),v&&a(Q,null,[a("span",null,null),a(ma,{active:e.persistentCounter||c.value,value:C.value,max:w.value},f.counter)])])}:void 0})}),la({},x,u,I)}}),wa={class:"d-flex flex-wrap justify-space-around mb-4"},_a={class:"text-h6"},Ca={class:"text-h6"},ka={class:"w-100"},Sa=ge({__name:"DatabaseList",setup(e){const p=new na(V.dbUrl);Xe();let l=y([]),t=y([]);const f=y("");let o=y({}),c=y(""),m=y(!1),b=y({});const C=i=>{o.value[i]!==void 0&&(b.value[i]=!1)},w=ga(P,500);async function P(){await p.getKeys(f.value).then(i=>l.value=i),t.value=[]}async function x(i){b.value[i]=!0,p.getValue(i).then(d=>{o.value[i]=JSON.parse(d)})}function u(i){const d=o.value[i];b.value[i]=!0,p.setValue(i,d)}async function g(){if(c.value!==""){const i=c.value;await p.setValue(i,""),l.value.push(i),c.value="",await x(i),t.value=[i]}}async function I(i){await p.deleteKey(i),t.value.splice(t.value.findIndex(d=>d===i),1),await P()}async function N(){const i=await p.getAll();let d="data:text/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(i)),n=document.createElement("a");n.setAttribute("href",d);const $=new Date;n.setAttribute("download",`${V.token.slug}-${$.toLocaleString()}.json`),document.body.appendChild(n),n.click(),n.remove()}return P(),(i,d)=>(D(),F(q,{class:"fill-height"},{default:r(()=>[a(ce,{class:"d-flex align-center text-center fill-height"},{default:r(()=>[a(oa,{class:"mx-auto",title:`Your database for ${s(V).token.slug}`},{default:r(()=>[a(sa,null,{default:r(()=>[h("The token is issued to "+K(s(V).token.user)+" and expires at "+K(s(V).viewExpireDate)+" and was issued at "+K(s(V).viewIssuedDate),1)]),_:1}),s(V).expiredToken?(D(),F(Z,{key:0},{default:r(()=>[a(ua,{prominent:"",type:"error",variant:"outlined"},{default:r(()=>[h(" You will need to get a new REPLIT DB URL. This one expired at "+K(s(V).viewExpireDate)+". Can press Logout above to enter a new url. ",1)]),_:1})]),_:1})):z("",!0),s(V).expiredToken?z("",!0):(D(),F(Z,{key:1},{default:r(()=>[a(q,null,{default:r(()=>[a(ce,null,{default:r(()=>[a(ve,{color:"primary",label:"Search For Key By Prefix",modelValue:f.value,"onUpdate:modelValue":[d[0]||(d[0]=n=>f.value=n),d[1]||(d[1]=n=>s(w)())]},null,8,["modelValue"]),a(ve,{color:"primary",label:"Add a new key","append-icon":"mdi-plus",modelValue:s(c),"onUpdate:modelValue":d[2]||(d[2]=n=>ne(c)?c.value=n:c=n),"onClick:append":g,onKeydown:Ze(g,["enter"])},null,8,["modelValue","onKeydown"]),a(q,null,{default:r(()=>[a(Y,{variant:"outlined",onClick:N},{default:r(()=>[a(j,null,{default:r(()=>[h("mdi-download")]),_:1}),h(" Download Backup ")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})),s(l).length===0?(D(),F(Z,{key:2},{default:r(()=>[h(" There is currently no database keys or any that match that prefix ")]),_:1})):z("",!0),a(Z,null,{default:r(()=>[k(a(Va,{multiple:"",modelValue:s(t),"onUpdate:modelValue":d[4]||(d[4]=n=>ne(t)?t.value=n:t=n),class:"mb-2"},{default:r(()=>[(D(!0),qe(Q,null,Qe(s(l),(n,$)=>(D(),F(ba,{key:$,value:n},{default:r(()=>[a(be,{onClick:_=>x(n)},{default:r(()=>[h(K(n),1)]),_:2},1032,["onClick"]),a(oe,null,{default:r(()=>[a(q,null,{default:r(()=>[X("div",wa,[a(Y,{class:"mb-2",disabled:s(b)[n],variant:"outlined",onClick:_=>u(n)},{default:r(()=>[a(j,null,{default:r(()=>[h("mdi-content-save")]),_:1}),h(" Save ")]),_:2},1032,["disabled","onClick"]),a(Y,{class:"mb-2",variant:"outlined",onClick:d[3]||(d[3]=_=>ne(m)?m.value=!s(m):m=!s(m))},{default:r(()=>[a(j,null,{default:r(()=>[h("mdi-file-document-edit-outline")]),_:1}),h(" "+K(s(m)?"Use the JSON Editor":"Use The Simple Editor"),1)]),_:1}),a(Y,{class:"mb-2",color:"error",variant:"outlined",onClick:_=>I(n)},{default:r(()=>[a(j,null,{default:r(()=>[h("mdi-delete")]),_:1}),h(" Delete ")]),_:2},1032,["onClick"])]),k(X("p",_a,"Note if there is no text below and this is a new key may have to click the three dots to create a new node",512),[[R,!s(m)]]),k(X("p",Ca,"Note if the key's value is a JSON object this simple editor does not parse it, will want to use the JSON editor",512),[[R,s(m)]]),k(a(oe,null,{default:r(()=>[h("Loading...")]),_:2},1536),[[R,s(o)[n]===void 0]]),k(X("div",ka,[!s(m)&&s(o)[n]!==void 0?(D(),F(s(ia),{key:0,modelValue:s(o)[n],"onUpdate:modelValue":_=>s(o)[n]=_,class:"jse-theme-dark",onChange:_=>C(n)},null,8,["modelValue","onUpdate:modelValue","onChange"])):z("",!0),k(a(ya,{counter:"",label:`Simple editor for the key ${n}`,onChange:_=>C(n),modelValue:s(o)[n],"onUpdate:modelValue":_=>s(o)[n]=_},null,8,["label","onChange","modelValue","onUpdate:modelValue"]),[[R,s(m)]])],512),[[R,s(o)[n]!==void 0]])]),_:2},1024)]),_:2},1024)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"]),[[R,s(l).length!==0&&!s(V).expiredToken]])]),_:1})]),_:1},8,["title"])]),_:1})]),_:1}))}}),Da=ge({__name:"DatabaseCRUDView",setup(e){return aa().params.id==="local"&&V.getLocalDbUrl(),V.dbUrl===""&&ea.push({name:"home"}),(t,f)=>s(V).dbUrl!==""?(D(),F(Sa,{key:0})):z("",!0)}});export{Da as default};
