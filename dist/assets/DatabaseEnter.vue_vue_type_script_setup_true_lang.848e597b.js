import{j as C,k as D,a as w,l as R,f as i,d as k,u as U,o as S,c as _,w as c,g as v,m as I,i as x,t as T,n as B,b as E,s as V,r as F}from"./index.cf337e7e.js";import{f as L,W as P,c as A,V as q,e as N,d as W}from"./lazy.c1fb1597.js";import{m as $,c as H,V as O}from"./VTextField.42825f50.js";function y(t){this.message=t}y.prototype=new Error,y.prototype.name="InvalidCharacterError";var g=typeof window<"u"&&window.atob&&window.atob.bind(window)||function(t){var r=String(t).replace(/=+$/,"");if(r.length%4==1)throw new y("'atob' failed: The string to be decoded is not correctly encoded.");for(var n,a,l=0,s=0,f="";a=r.charAt(s++);~a&&(n=l%4?64*n+a:a,l++%4)?f+=String.fromCharCode(255&n>>(-2*l&6)):0)a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(a);return f};function j(t){var r=t.replace(/-/g,"+").replace(/_/g,"/");switch(r.length%4){case 0:break;case 2:r+="==";break;case 3:r+="=";break;default:throw"Illegal base64url string!"}try{return function(n){return decodeURIComponent(g(n).replace(/(.)/g,function(a,l){var s=l.charCodeAt(0).toString(16).toUpperCase();return s.length<2&&(s="0"+s),"%"+s}))}(r)}catch{return g(r)}}function h(t){this.message=t}function J(t,r){if(typeof t!="string")throw new h("Invalid token specified");var n=(r=r||{}).header===!0?0:1;try{return JSON.parse(j(t.split(".")[n]))}catch(a){throw new h("Invalid token specified: "+a.message)}}h.prototype=new Error,h.prototype.name="InvalidTokenError";const Y=C("v-code"),z=D({name:"VForm",props:{...$()},emits:{"update:modelValue":t=>!0,submit:t=>!0},setup(t,r){let{slots:n,emit:a}=r;const l=H(t),s=w();function f(u){u.preventDefault(),l.reset()}function p(u){const o=u,e=l.validate();o.then=e.then.bind(e),o.catch=e.catch.bind(e),o.finally=e.finally.bind(e),a("submit",o),o.defaultPrevented||e.then(d=>{let{valid:b}=d;if(b){var m;(m=s.value)==null||m.submit()}}),o.preventDefault()}return R(()=>{var u;return i("form",{ref:s,class:"v-form",novalidate:!0,onReset:f,onSubmit:p},[(u=n.default)==null?void 0:u.call(n,l)])}),L(l,s)}}),G=C("flex-grow-1","div","VSpacer"),X=k({__name:"DatabaseEnter",props:{local:{type:Boolean,default:!0}},setup(t){const r=t,n=new P(""),a=w(""),l=w(!1),{mobile:s}=U();function f(o){let e;try{e=new URL(o)}catch{return!1}return e.protocol==="http:"||e.protocol==="https:"}const p={url:o=>f(o)||"This is not formatted as a url",required:o=>!!o||"Required."};async function u(o){if(o.preventDefault(),r.local)try{const b=new URL(a.value).pathname.split("/")[2],m=J(b);V.setDbUrl(a.value,m),await F.push({name:"db-view",params:{id:"local"}})}catch(e){alert("I have reason to believe that this is not a Replit db url. Check console for a tiny bit more info."),console.log(e)}else try{await n.addDatabase(a.value),V.userDatabases=await n.listDatabases()}catch(e){alert("I have reason to believe that this is not a Replit db url. Check console for a tiny bit more info."),console.log("Can also be an issue with the server."),console.log(e)}}return(o,e)=>(S(),_(W,{class:"mx-auto",title:"Enter your Replit DB URL",width:E(s)?"100%":"75%"},{default:c(()=>[i(A,null,{default:c(()=>[v("You can find your Replit DB Url by typing the command below into your Replit shell.")]),_:1}),i(Y,null,{default:c(()=>[v('echo "$REPLIT_DB_URL"')]),_:1}),i(z,{onSubmit:u,modelValue:l.value,"onUpdate:modelValue":e[1]||(e[1]=d=>l.value=d)},{default:c(()=>[i(q,null,{default:c(()=>[i(O,{modelValue:a.value,"onUpdate:modelValue":e[0]||(e[0]=d=>a.value=d),color:"primary",rules:[p.url,p.required],label:"Data base url",variant:"underlined",autofocus:"",type:"url"},null,8,["modelValue","rules"])]),_:1}),i(I),i(N,null,{default:c(()=>[i(G),i(x,{color:"success",type:"submit",disabled:!l.value},{default:c(()=>[v(T(t.local?"View Database":"Add a new database")+" ",1),i(B,{icon:"mdi-chevron-right",end:""})]),_:1},8,["disabled"])]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["width"]))}});export{X as _,J as o};
