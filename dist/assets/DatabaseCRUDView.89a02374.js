import{j as J,aV as Se,G as fe,x as Pe,aW as Ie,J as Te,W as S,p as Ee,ab as ue,k as W,e as a,R as $e,ac as pe,ah as me,X as k,Y as xe,m as O,a0 as De,I as re,al as R,aX as Be,A as Re,aY as Fe,E as Ne,aZ as Ae,O as Ue,T as Ke,a9 as je,ax as Le,a6 as Ge,a as y,av as Oe,a1 as L,au as He,ay as ze,a2 as te,am as q,a_ as Je,a8 as de,aA as We,aj as Me,aN as Ye,d as ge,s as V,o as D,c as F,w as u,V as ce,u as s,f as h,t as K,g as H,a$ as le,b0 as Xe,h as X,b1 as Ze,b2 as qe,b as ne,r as Qe,b3 as ea}from"./index.e2c7bcbb.js";import{m as he,u as aa,f as ta,W as la,d as na,b as oa,c as Z,V as G}from"./lazy.f2ba3b05.js";import{_ as sa}from"./json-editor-vue.e1d562a2.js";import{V as ia}from"./VAlert.d97f589c.js";import{a as ua,b as ra,u as da,f as ca,d as va,e as fa,g as pa,h as ma,V as ve}from"./VTextField.e1883e3b.js";function xa(e,p,l){var t,f,o;p===void 0&&(p=50),l===void 0&&(l={});var c=(t=l.isImmediate)!=null&&t,m=(f=l.callback)!=null&&f,b=l.maxWait,C=Date.now(),w=[];function P(){if(b!==void 0){var r=Date.now()-C;if(r+p>=b)return b-r}return p}var x=function(){var r=[].slice.call(arguments),g=this;return new Promise(function(I,N){var i=c&&o===void 0;if(o!==void 0&&clearTimeout(o),o=setTimeout(function(){if(o=void 0,C=Date.now(),!c){var n=e.apply(g,r);m&&m(n),w.forEach(function(B){return(0,B.resolve)(n)}),w=[]}},P()),i){var d=e.apply(g,r);return m&&m(d),I(d)}w.push({resolve:I,reject:N})})};return x.cancel=function(r){o!==void 0&&clearTimeout(o),w.forEach(function(g){return(0,g.reject)(r)}),w=[]},x}const z=Symbol.for("vuetify:v-expansion-panel"),ga=["default","accordion","inset","popout"],ha=J({name:"VExpansionPanels",props:{color:String,variant:{type:String,default:"default",validator:e=>ga.includes(e)},readonly:Boolean,...Se(),...fe(),...Pe()},emits:{"update:modelValue":e=>!0},setup(e,p){let{slots:l}=p;Ie(e,z);const{themeClasses:t}=Te(e),f=S(()=>e.variant&&`v-expansion-panels--variant-${e.variant}`);return Ee({VExpansionPanel:{color:ue(e,"color")},VExpansionPanelTitle:{readonly:ue(e,"readonly")}}),W(()=>a(e.tag,{class:["v-expansion-panels",t.value,f.value]},l)),{}}}),Ve=De({color:String,expandIcon:{type:re,default:"$expand"},collapseIcon:{type:re,default:"$collapse"},hideActions:Boolean,ripple:{type:[Boolean,Object],default:!1},readonly:Boolean},"v-expansion-panel-title"),be=J({name:"VExpansionPanelTitle",directives:{Ripple:$e},props:{...Ve()},setup(e,p){let{slots:l}=p;const t=pe(z);if(!t)throw new Error("[Vuetify] v-expansion-panel-title needs to be placed inside v-expansion-panel");const{backgroundColorClasses:f,backgroundColorStyles:o}=me(e,"color"),c=S(()=>({collapseIcon:e.collapseIcon,disabled:t.disabled.value,expanded:t.isSelected.value,expandIcon:e.expandIcon,readonly:e.readonly}));return W(()=>{var m;return k(a("button",{class:["v-expansion-panel-title",{"v-expansion-panel-title--active":t.isSelected.value},f.value],style:o.value,type:"button",tabindex:t.disabled.value?-1:void 0,disabled:t.disabled.value,"aria-expanded":t.isSelected.value,onClick:e.readonly?void 0:t.toggle},[a("span",{class:"v-expansion-panel-title__overlay"},null),(m=l.default)==null?void 0:m.call(l,c.value),!e.hideActions&&a("span",{class:"v-expansion-panel-title__icon"},[l.actions?l.actions(c.value):a(O,{icon:t.isSelected.value?e.collapseIcon:e.expandIcon},null)])]),[[xe("ripple"),e.ripple]])}),{}}}),oe=J({name:"VExpansionPanelText",props:{...he()},setup(e,p){let{slots:l}=p;const t=pe(z);if(!t)throw new Error("[Vuetify] v-expansion-panel-text needs to be placed inside v-expansion-panel");const{hasContent:f,onAfterLeave:o}=aa(e,t.isSelected);return W(()=>{var c;return a(Be,{onAfterLeave:o},{default:()=>[k(a("div",{class:"v-expansion-panel-text"},[l.default&&f.value&&a("div",{class:"v-expansion-panel-text__wrapper"},[(c=l.default)==null?void 0:c.call(l)])]),[[R,t.isSelected.value]])]})}),{}}}),Va=J({name:"VExpansionPanel",props:{title:String,text:String,bgColor:String,...Re(),...Fe(),...he(),...Ne(),...fe(),...Ve()},emits:{"group:selected":e=>!0},setup(e,p){let{slots:l}=p;const t=Ae(e,z),{backgroundColorClasses:f,backgroundColorStyles:o}=me(e,"bgColor"),{elevationClasses:c}=Ue(e),{roundedClasses:m}=Ke(e),b=S(()=>(t==null?void 0:t.disabled.value)||e.disabled),C=S(()=>t.group.items.value.reduce((x,r,g)=>(t.group.selected.value.includes(r.id)&&x.push(g),x),[])),w=S(()=>{const x=t.group.items.value.findIndex(r=>r.id===t.id);return!t.isSelected.value&&C.value.some(r=>r-x===1)}),P=S(()=>{const x=t.group.items.value.findIndex(r=>r.id===t.id);return!t.isSelected.value&&C.value.some(r=>r-x===-1)});return je(z,t),W(()=>{var x;const r=!!(l.text||e.text),g=!!(l.title||e.title);return a(e.tag,{class:["v-expansion-panel",{"v-expansion-panel--active":t.isSelected.value,"v-expansion-panel--before-active":w.value,"v-expansion-panel--after-active":P.value,"v-expansion-panel--disabled":b.value},m.value,f.value],style:o.value,"aria-expanded":t.isSelected.value},{default:()=>[a("div",{class:["v-expansion-panel__shadow",...c.value]},null),g&&a(be,{key:"title",collapseIcon:e.collapseIcon,color:e.color,expandIcon:e.expandIcon,hideActions:e.hideActions,ripple:e.ripple},{default:()=>[l.title?l.title():e.title]}),r&&a(oe,{key:"text",eager:e.eager},{default:()=>[l.text?l.text():e.text]}),(x=l.default)==null?void 0:x.call(l)]})}),{}}});const ba=J({name:"VTextarea",directives:{Intersect:Le},inheritAttrs:!1,props:{autoGrow:Boolean,autofocus:Boolean,counter:[Boolean,Number,String],counterValue:Function,hint:String,persistentHint:Boolean,prefix:String,placeholder:String,persistentPlaceholder:Boolean,persistentCounter:Boolean,noResize:Boolean,rows:{type:[Number,String],default:5,validator:e=>!isNaN(parseFloat(e))},maxRows:{type:[Number,String],validator:e=>!isNaN(parseFloat(e))},suffix:String,...ua(),...ra()},emits:{"click:control":e=>!0,"update:focused":e=>!0,"update:modelValue":e=>!0},setup(e,p){let{attrs:l,emit:t,slots:f}=p;const o=Ge(e,"modelValue"),{isFocused:c,focus:m,blur:b}=da(e),C=S(()=>typeof e.counterValue=="function"?e.counterValue(o.value):(o.value||"").toString().length),w=S(()=>{if(l.maxlength)return l.maxlength;if(!(!e.counter||typeof e.counter!="number"&&typeof e.counter!="string"))return e.counter});function P(v,T){var E,$;!e.autofocus||!v||(E=T[0].target)==null||($=E.focus)==null||$.call(E)}const x=y(),r=y(),g=y(""),I=y(),N=S(()=>c.value||e.persistentPlaceholder),i=S(()=>e.messages.length?e.messages:N.value||e.persistentHint?e.hint:"");function d(){if(I.value!==document.activeElement){var v;(v=I.value)==null||v.focus()}c.value||m()}function n(v){d(),t("click:control",v)}function B(v){v.stopPropagation(),d(),de(()=>{o.value="",We(e["onClick:clear"],v)})}function _(v){o.value=v.target.value}const A=y();function U(){!e.autoGrow||de(()=>{if(!A.value||!r.value)return;const v=getComputedStyle(A.value),T=getComputedStyle(r.value.$el),E=parseFloat(v.getPropertyValue("--v-field-padding-top"))+parseFloat(v.getPropertyValue("--v-input-padding-top"))+parseFloat(v.getPropertyValue("--v-field-padding-bottom")),$=A.value.scrollHeight,Q=parseFloat(v.lineHeight),ee=Math.max(parseFloat(e.rows)*Q+E,parseFloat(T.getPropertyValue("--v-input-control-height"))),ae=parseFloat(e.maxRows)*Q+E||1/0;g.value=Me(Ye($!=null?$:0,ee,ae))})}Oe(U),L(o,U),L(()=>e.rows,U),L(()=>e.maxRows,U),L(()=>e.density,U);let M;return L(A,v=>{if(v)M=new ResizeObserver(U),M.observe(A.value);else{var T;(T=M)==null||T.disconnect()}}),He(()=>{var v;(v=M)==null||v.disconnect()}),W(()=>{const v=!!(f.counter||e.counter||e.counterValue),T=!!(v||f.details),[E,$]=ze(l),[{modelValue:Q,...ee}]=ca(e),[ae]=va(e);return a(ma,te({ref:x,modelValue:o.value,"onUpdate:modelValue":j=>o.value=j,class:["v-textarea v-text-field",{"v-textarea--prefixed":e.prefix,"v-textarea--suffixed":e.suffix,"v-text-field--prefixed":e.prefix,"v-text-field--suffixed":e.suffix,"v-textarea--auto-grow":e.autoGrow,"v-textarea--no-resize":e.noResize||e.autoGrow,"v-text-field--flush-details":["plain","underlined"].includes(e.variant)}],"onClick:prepend":e["onClick:prepend"],"onClick:append":e["onClick:append"]},E,ee,{focused:c.value,messages:i.value}),{...f,default:j=>{let{isDisabled:Y,isDirty:se,isReadonly:ye,isValid:we}=j;return a(fa,te({ref:r,style:{"--v-textarea-control-height":g.value},"onClick:control":n,"onClick:clear":B,"onClick:prependInner":e["onClick:prependInner"],"onClick:appendInner":e["onClick:appendInner"],role:"textbox"},ae,{active:N.value||se.value,dirty:se.value||e.dirty,focused:c.value,error:we.value===!1}),{...f,default:_e=>{let{props:{class:ie,...Ce}}=_e;return a(q,null,[e.prefix&&a("span",{class:"v-text-field__prefix"},[e.prefix]),k(a("textarea",te({ref:I,class:ie,value:o.value,onInput:_,autofocus:e.autofocus,readonly:ye.value,disabled:Y.value,placeholder:e.placeholder,rows:e.rows,name:e.name,onFocus:d,onBlur:b},Ce,$),null),[[xe("intersect"),{handler:P},null,{once:!0}]]),e.autoGrow&&k(a("textarea",{class:[ie,"v-textarea__sizer"],"onUpdate:modelValue":ke=>o.value=ke,ref:A,readonly:!0,"aria-hidden":"true"},null),[[Je,o.value]]),e.suffix&&a("span",{class:"v-text-field__suffix"},[e.suffix])])}})},details:T?j=>{var Y;return a(q,null,[(Y=f.details)==null?void 0:Y.call(f,j),v&&a(q,null,[a("span",null,null),a(pa,{active:e.persistentCounter||c.value,value:C.value,max:w.value},f.counter)])])}:void 0})}),ta({},x,r,I)}}),ya={class:"d-flex justify-space-around mb-4"},wa={class:"text-h6"},_a={class:"text-h6"},Ca=ge({__name:"DatabaseList",props:{dbUrl:String,token:{type:Object,default(){return{iat:0,exp:0,user:"",slug:""}}}},setup(e){const p=new la(V.dbUrl);let l=y([]),t=y([]);const f=y("");let o=y({}),c=y(""),m=y(!1),b=y({});const C=i=>{o.value[i]!==void 0&&(b.value[i]=!1)},w=xa(P,500);async function P(){await p.getKeys(f.value).then(i=>l.value=i),t.value=[]}async function x(i){b.value[i]=!0,p.getValue(i).then(d=>{o.value[i]=JSON.parse(d)})}function r(i){const d=o.value[i];b.value[i]=!0,p.setValue(i,d)}async function g(){if(c.value!==""){const i=c.value;await p.setValue(i,""),l.value.push(i),c.value="",await x(i),t.value=[i]}}async function I(i){await p.deleteKey(i),t.value.splice(t.value.findIndex(d=>d===i),1),await P()}async function N(){const i=await p.getAll();let d="data:text/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(i)),n=document.createElement("a");n.setAttribute("href",d);const B=new Date;n.setAttribute("download",`${V.token.slug}-${B.toLocaleString()}.json`),document.body.appendChild(n),n.click(),n.remove()}return P(),(i,d)=>(D(),F(G,{class:"fill-height"},{default:u(()=>[a(ce,{class:"d-flex align-center text-center fill-height"},{default:u(()=>[a(na,{class:"mx-auto",title:`Your database for ${s(V).token.slug}`},{default:u(()=>[a(oa,null,{default:u(()=>[h("The token is issued to "+K(s(V).token.user)+" and expires at "+K(s(V).viewExpireDate)+" and was issued at "+K(s(V).viewIssuedDate),1)]),_:1}),s(V).expiredToken?(D(),F(Z,{key:0},{default:u(()=>[a(ia,{prominent:"",type:"error",variant:"outlined"},{default:u(()=>[h(" You will need to get a new REPLIT DB URL. This one expired at "+K(s(V).viewExpireDate)+". Can press Logout above to enter a new url. ",1)]),_:1})]),_:1})):H("",!0),s(V).expiredToken?H("",!0):(D(),F(Z,{key:1},{default:u(()=>[a(G,null,{default:u(()=>[a(ce,null,{default:u(()=>[a(ve,{color:"primary",label:"Search For Key By Prefix",modelValue:f.value,"onUpdate:modelValue":[d[0]||(d[0]=n=>f.value=n),d[1]||(d[1]=n=>s(w)())]},null,8,["modelValue"]),a(ve,{color:"primary",label:"Add a new key","append-icon":"mdi-plus",modelValue:s(c),"onUpdate:modelValue":d[2]||(d[2]=n=>le(c)?c.value=n:c=n),"onClick:append":g,onKeydown:Xe(g,["enter"])},null,8,["modelValue","onKeydown"]),a(G,null,{default:u(()=>[a(X,{variant:"outlined",onClick:N},{default:u(()=>[a(O,null,{default:u(()=>[h("mdi-download")]),_:1}),h(" Download Backup ")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})),s(l).length===0?(D(),F(Z,{key:2},{default:u(()=>[h(" There is currently no database keys or any that match that prefix ")]),_:1})):H("",!0),a(Z,null,{default:u(()=>[k(a(ha,{multiple:"",modelValue:s(t),"onUpdate:modelValue":d[4]||(d[4]=n=>le(t)?t.value=n:t=n),class:"mb-2"},{default:u(()=>[(D(!0),Ze(q,null,qe(s(l),(n,B)=>(D(),F(Va,{key:B,value:n},{default:u(()=>[a(be,{onClick:_=>x(n)},{default:u(()=>[h(K(n),1)]),_:2},1032,["onClick"]),a(oe,null,{default:u(()=>[a(G,null,{default:u(()=>[ne("div",ya,[a(X,{disabled:s(b)[n],variant:"outlined",onClick:_=>r(n)},{default:u(()=>[a(O,null,{default:u(()=>[h("mdi-content-save")]),_:1}),h(" Save ")]),_:2},1032,["disabled","onClick"]),a(X,{variant:"outlined",onClick:d[3]||(d[3]=_=>le(m)?m.value=!s(m):m=!s(m))},{default:u(()=>[a(O,null,{default:u(()=>[h("mdi-file-document-edit-outline")]),_:1}),h(" "+K(s(m)?"Use the JSON Editor (for complex objects)":"Use The Simple Editor (For string values)"),1)]),_:1}),a(X,{color:"error",variant:"outlined",onClick:_=>I(n)},{default:u(()=>[a(O,null,{default:u(()=>[h("mdi-delete")]),_:1}),h(" Delete ")]),_:2},1032,["onClick"])]),k(ne("p",wa,"Note if there is no text below and this is a new key may have to click the three dots to create a new node",512),[[R,!s(m)]]),k(ne("p",_a,"Note if the key's value is a JSON object this simple editor does not parse it, will want to use the JSON editor",512),[[R,s(m)]]),k(a(oe,null,{default:u(()=>[h("Loading...")]),_:2},1536),[[R,s(o)[n]===void 0]]),k(a(G,null,{default:u(()=>[!s(m)&&s(o)[n]!==void 0?(D(),F(s(sa),{key:0,modelValue:s(o)[n],"onUpdate:modelValue":_=>s(o)[n]=_,class:"jse-theme-dark",onChange:_=>C(n)},null,8,["modelValue","onUpdate:modelValue","onChange"])):H("",!0),k(a(ba,{counter:"",label:`Simple editor for the key ${n}`,onChange:_=>C(n),modelValue:s(o)[n],"onUpdate:modelValue":_=>s(o)[n]=_},null,8,["label","onChange","modelValue","onUpdate:modelValue"]),[[R,s(m)]])]),_:2},1536),[[R,s(o)[n]!==void 0]])]),_:2},1024)]),_:2},1024)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"]),[[R,s(l).length!==0&&!s(V).expiredToken]])]),_:1})]),_:1},8,["title"])]),_:1})]),_:1}))}}),Ea=ge({__name:"DatabaseCRUDView",setup(e){return ea().params.id==="local"&&V.getLocalDbUrl(),V.dbUrl===""&&Qe.push({name:"home"}),(t,f)=>s(V).dbUrl!==""?(D(),F(Ca,{key:0})):H("",!0)}});export{Ea as default};
